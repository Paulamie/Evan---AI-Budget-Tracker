{% extends "base2.html" %}

{% block head %}
{% block title %}
    {{ super() }}
{% endblock %}
<style>
    .chat-container {
        margin-left: 220px; /* if you have a sidebar of width 220px */
        padding: 20px;
        background: #E6E6FA;
        min-height: 100vh;
    }

    .chat-box {
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 6px;
        padding: 20px;
        width: 60%;
        margin-bottom: 20px;
    }

    .message {
        margin-bottom: 15px;
        line-height: 1.5;
    }

    .user-message {
        font-weight: bold;
        color: #4B0082;
    }

    .assistant-message {
        color: #666;
        margin-left: 20px; /* indent Evanâ€™s responses if desired */
    }

    .chat-form {
        display: flex;
        gap: 10px;
    }

    .chat-form input[type="text"] {
        flex: 1;
        padding: 8px;
    }

    .chat-form button {
        background-color: #C8A2C8;
        color: #fff;
        border: none;
        border-radius: 3px;
        padding: 8px 16px;
        cursor: pointer;
    }

    .chat-form button:hover {
        background-color: #4B0082;
    }
</style>
{% endblock %}

{% block content %}
<body>
    <div class="tab">
        <button type="button" onclick="location.href='/userhome/';"> Home Page</button>
        <button type="button" onclick="location.href='/userAccount';">My Account</button>
        <button type="button" onclick="location.href='/view_budget';">View Budget</button>
        <button type="button" onclick="location.href='/createBudget';">Create Budget</button>
        <button type="button" onclick="location.href='/report';">Your Patterns</button>
        <button type="button" onclick="location.href='/calendarView';">Calendar View</button>
        <button type="button" onclick="location.href='/investments';">Investments Tracking</button>
        <button type="button" onclick="location.href='/chat';">Chat to Evan</button>
        <button type="button" onclick="location.href='/privacyStatement';">Privacy</button>
        <button type="button" onclick="location.href='/cookies';">Cookies</button>
        <button type="button" onclick="location.href='/logout';">Logout</button>
    </div>

    <div class="chat-container">
        <h1>Chat with Evan</h1>
        
        <div class="chat-box">
            {% for msg in conversation %}
                {% if msg.role == 'user' %}
                <div class="message user-message">
                    You: {{ msg.text }}
                </div>
                {% else %}
                <div class="message assistant-message">
                    Evan: {{ msg.text }}
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Chat input form (POST to /chat) -->
        <form method="POST" class="chat-form" action="{{ url_for('clear_chat') }}">
            <input type="text" name="user_message" placeholder="Ask Evan something..." required>
            <button type="submit">Send</button>
        </form>

        <!-- Clear Chat button (POST to /chat/clear) -->
        <form method="POST" action="{{ url_for('clear_chat') }}" style="margin-top: 10px;">
            <button type="submit"
                    style="background-color: #888; border: none; border-radius: 3px; padding: 8px 16px; cursor: pointer; color: #fff;">
                Clear Chat
            </button>
        </form>
    </div>
</body>
{% endblock %}

{% block footer %}
{{ super() }}
{% endblock %}